library(colorspace)
library("yaml")
install.packages("yaml")
install.packages("colorspace")
install.packages("colorspace")
library(colorspace)
library("colorspace")
time_ftrRGB <- system.time(rgb_feature <- featureRGB(img_dir,export = T))
source("../lib/feature.R")
time_ftrRGB <- system.time(rgb_feature <- featureRGB(img_train_dir,export = T))
experiment_dir <- "../data/train/" # This will be modified for different data sets.
img_train_dir <- paste(experiment_dir, "train/", sep="")
img_test_dir <- paste(experiment_dir, "test/", sep="")
time_ftrRGB <- system.time(rgb_feature <- featureRGB(img_train_dir,export = T))
source("../lib/feature.R")
time_ftrRGB <- system.time(rgb_feature <- featureRGB(img_train_dir,export = T))
source("../lib/feature.R")
time_ftrRGB <- system.time(rgb_feature <- featureRGB(img_train_dir,export = T))
rgb_feature <- featureRGB(img_train_dir,export = T)
source("../lib/feature.R")
time_ftrRGB <- system.time(rgb_feature <- featureRGB(img_train_dir,export = T))
rgb_feature <- featureRGB(img_train_dir,export = T)
img_dir <- "../data/train/train/images/"
time_ftr <- system.time(rgb_feature <- featureRGB(img_dir,export = T))
img_dir <- "../data/train/train/"
time_ftr <- system.time(rgb_feature <- featureRGB(img_dir,export = T))
setwd("C:/Users/50347/Documents/Columbia Courses/2nd semester/GR5241/Homework")
exp(-0.5154718)
exp(-0.06082076)
(log(100)-4)/3
pnorm((log(100)-4)/3)
library(ggplot2)
df <- data.frame("t"=1:length(data),"data"=data)
df <- data.frame("t"=1:length(data),"data"=data)
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
df <- data.frame("t"=1:length(data),"data"=data)
View(df)
ggplot(df,aes(x=t,y=log(-log(data))))+
geom_point()
log(-log(data))
log(data)
-log(data)
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(data),1,
S_est,n=length(data))
df <- data.frame("t"=1:length(data),"data"=data)
#ggplot(df,aes(x=t,y=log(-log(data))))+
#  geom_point()
S_hat
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(1:length(data)),1,
S_est,n=length(data))
df <- data.frame("t"=1:length(data),"data"=data)
#ggplot(df,aes(x=t,y=log(-log(data))))+
#  geom_point()
S_hat
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(1:length(data)),1,
S_est,n=length(data))
df <- data.frame("t"=1:length(data),"S_hat"=S_hat)
ggplot(df,aes(x=t,y=log(-log(S_hat))))+
geom_point()
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(1:length(data)),1,
S_est,n=length(data))
df <- data.frame("i"=1:length(data),"S_hat"=S_hat)
ggplot(df,aes(x=i,y=log(-log(S_hat))))+
geom_point() +
xlab("order") +
ylab("Estimate of log(-log(S(t)))")
View(df)
fit <- lm(log(-log(S_hat))~i,data = df)
fit$coefficients
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(1:length(data)),1,
S_est,n=length(data))
df <- data.frame("data"=data,"S_hat"=S_hat)
ggplot(df,aes(x=i,y=log(-log(S_hat))))+
geom_point() +
xlab("order") +
ylab("Estimate of log(-log(S(t)))")
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(1:length(data)),1,
S_est,n=length(data))
df <- data.frame("data"=data,"S_hat"=S_hat)
ggplot(df,aes(x=data,y=log(-log(S_hat))))+
geom_point() +
xlab("t") +
ylab("Estimate of log(-log(S(t)))")
data <- c(143,164,188,188,190,192,206,209,
213,216,220,227,230,234,246,265,304)
S_est<- function(i,n){return(1-(i-0.5)/n)}
S_hat <- apply(data.frame(1:length(data)),1,
S_est,n=length(data))
df <- data.frame("data"=data,"S_hat"=S_hat)
ggplot(df,aes(x=log(data),y=log(-log(S_hat))))+
geom_point() +
xlab("log(t)") +
ylab("Estimate of log(-log(S(t)))")
View(df)
fit <- lm(log(-log(S_hat))~log(data),data = df)
fit$coefficients
fit <- lm(log(-log(S_hat))~log(data),data = df)
coeff <- fit$coefficients
beta <- coeff[2]
alpha <- exp(coeff[1]/coeff[2])
beta
alpha
fit <- lm(log(-log(S_hat))~log(data),data = df)
coeff <- fit$coefficients
beta <- coeff[2]
alpha <- exp(coeff[1]/coeff[2])
1/alpha
beta
library(plyr)
library(reshape)
library(reshape2)
train <- read.csv("~/Columbia Courses/2nd semester/GR5243/data_sample/data_sample/MS_sample/data_train.csv")
train <- train[,-1]
uniq <- unique(train$V2)
num_vroot <- length(uniq[nchar(uniq)==4])
num_user <- length(uniq)-num_vroot
idx_c <- which(train$V1=="C")
user_id <- as.character(train[idx_c,2])
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(train)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- train[-idx_c,]
temp$user <- user
head(temp)
temp <- temp[,-1]
head(temp)
colnames(temp) <- c("vroot","click","user")
wide <- dcast(temp,user~...)
wide[1,1]
wide[1,2]
wide[2,3]
colnames(wide)
head(temp)
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
wide[1,1]
wide[1,2]
wide[1,3]
wide[1,4]
wide[1,]
head(wide[1,])
head(wide[,1])
head(wide[,2])
wide[1:5,1:5]
library(reshape)
library(reshape2)
process_MS <- function(df,export = FALSE){
uniq <- unique(df$V2)
user_id <- as.character(uniq[nchar(uniq)==5])
vroot_id <- setdiff(uniq,user_id)
num_user <- length(user_id)
num_vroot <- length(vroot_id)
idx_c <- which(df$V1=="C")
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(df)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- data.frame("vroot"=df[-idx_c,"V2"],
"user"=user)
temp <- train[-idx_c,]
temp$user <- user
temp <- temp[,-1]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
if(export){
write.csv("MS_process.csv")
}
return(wide)
}
train <- read.csv("~/Columbia Courses/2nd semester/GR5243/data_sample/data_sample/MS_sample/data_train.csv")
wide_train <- process_MS(train)
View(wide_train)
library(reshape)
library(reshape2)
process_MS <- function(df,export = FALSE){
uniq <- unique(df$V2)
user_id <- as.character(uniq[nchar(uniq)==5])
vroot_id <- setdiff(uniq,user_id)
num_user <- length(user_id)
num_vroot <- length(vroot_id)
idx_c <- which(df$V1=="C")
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(df)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- train[-idx_c,]
temp$user <- user
temp <- temp[,-1]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
if(export){
write.csv("MS_process.csv")
}
return(wide)
}
wide_train <- process_MS(train)
df <- read.csv("~/Columbia Courses/2nd semester/GR5243/data_sample/data_sample/MS_sample/data_train.csv")
df <- read.csv("~/Columbia Courses/2nd semester/GR5243/data_sample/data_sample/MS_sample/data_train.csv")
uniq <- unique(df$V2)
user_id <- as.character(uniq[nchar(uniq)==5])
vroot_id <- setdiff(uniq,user_id)
num_user <- length(user_id)
num_vroot <- length(vroot_id)
idx_c <- which(df$V1=="C")
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(df)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- train[-idx_c,]
temp <- df[-idx_c,]
library(reshape)
library(reshape2)
process_MS <- function(df,export = FALSE){
uniq <- unique(df$V2)
user_id <- as.character(uniq[nchar(uniq)==5])
vroot_id <- setdiff(uniq,user_id)
num_user <- length(user_id)
num_vroot <- length(vroot_id)
idx_c <- which(df$V1=="C")
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(df)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- df[-idx_c,]
temp$user <- user
temp <- temp[,-1]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
if(export){
write.csv("MS_process.csv")
}
return(wide)
}
wide_train <- process_MS(train)
library(reshape)
library(reshape2)
process_MS <- function(df,export = FALSE){
uniq <- unique(df$V2)
user_id <- as.character(uniq[nchar(uniq)==5])
vroot_id <- setdiff(uniq,user_id)
num_user <- length(user_id)
num_vroot <- length(vroot_id)
idx_c <- which(df$V1=="C")
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(df)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- df[-idx_c,]
temp$user <- user
temp <- temp[,-1]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
if(export){
write.csv("MS_process.csv")
}
return(wide)
}
wide_train <- process_MS(df)
temp <- df[-idx_c,]
temp$user <- user
head(temp)
temp <- temp[,-1]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
head(temp)
temp <- df[-idx_c,]
temp$user <- user
head(temp)
temp <- temp[,-c(1,2)]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
library(reshape)
library(reshape2)
process_MS <- function(df,export = FALSE){
uniq <- unique(df$V2)
user_id <- as.character(uniq[nchar(uniq)==5])
vroot_id <- setdiff(uniq,user_id)
num_user <- length(user_id)
num_vroot <- length(vroot_id)
idx_c <- which(df$V1=="C")
user_visits <- diff(idx_c)-1
user_visits <- c(user_visits,
nrow(df)-idx_c[length(idx_c)])
user <- rep(user_id,user_visits)
temp <- df[-idx_c,]
temp$user <- user
temp <- temp[,-c(1,2)]
colnames(temp) <- c("vroot","click","user")
temp <- temp[,c(1,3,2)]
wide <- dcast(temp,user~...)
if(export){
write.csv("MS_process.csv")
}
return(wide)
}
wide_train <- process_MS(df)
write.csv(wide_train, "train_1.csv")
getwd9)
getwd())
getwd()
rm(wide_train)
rm(wide)
test <- read.csv("~/Columbia Courses/2nd semester/GR5243/data_sample/data_sample/MS_sample/data_test.csv")
wide_test <- process_MS(test)
write.csv(wide_test, "test_1.csv")
setwd("C:/Users/50347/Documents/Columbia Courses/2nd semester/GR5223/Homework")
R <- matrix(c(1,0.37,0.21,0.26,0.33,
0.37,1,0.35,0.67,0.59,
0.21,0.35,1,0.34,0.34,
0.26,0.67,0.34,1,0.8,
0.33,0.59,0.34,0.8,1),ncol = 5,byrow = T)
R.xx <- R[1:3,1:3]
R.xy <- R[1:3,4:5]
R.yx <- R[4:5,1:3]
R.yy <- R[4:5,4:5]
sp <- eigen(R.xx)
Rxx.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
sp <- eigen(R.yy)
Ryy.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
K.hat <- Rxx.invsqrt%*%R.xy%*%Ryy.invsqrt
foo <- svd(K.hat)
sqrt(foo$d)
n <- 70;p<-3;q<-2;
r <- sqrt(foo$d)
Lambda0 <- prod(1-r^2)
obs <- -(n-(p+q+3)/2)*log(Lambda0)
1-pchisq(obs,df = p*q)
Lambda1 <- prod(1-r[2]^2)
obs2 <- -(n-(p+q+3)/2)*log(Lambda1)
s <- 1
1-pchisq(obs2,df = (p-s)*(q-s))
R <- matrix(c(1,0.37,0.21,0.26,0.33,
0.37,1,0.35,0.67,0.59,
0.21,0.35,1,0.34,0.34,
0.26,0.67,0.34,1,0.8,
0.33,0.59,0.34,0.8,1),ncol = 5,byrow = T)
R.xx <- R[1:3,1:3]
R.xy <- R[1:3,4:5]
R.yx <- R[4:5,1:3]
R.yy <- R[4:5,4:5]
sp1 <- eigen(R.xx)
Rxx.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
sp2 <- eigen(R.yy)
Ryy.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
K.hat <- Rxx.invsqrt%*%R.xy%*%Ryy.invsqrt
R <- matrix(c(1,0.37,0.21,0.26,0.33,
0.37,1,0.35,0.67,0.59,
0.21,0.35,1,0.34,0.34,
0.26,0.67,0.34,1,0.8,
0.33,0.59,0.34,0.8,1),ncol = 5,byrow = T)
R.xx <- R[1:3,1:3]
R.xy <- R[1:3,4:5]
R.yx <- R[4:5,1:3]
R.yy <- R[4:5,4:5]
sp1 <- eigen(R.xx)
Rxx.invsqrt <- sp1$vectors%*%diag(1/sqrt(sp1$values))%*%t(sp1$vectors)
sp2 <- eigen(R.yy)
Ryy.invsqrt <- sp2$vectors%*%diag(1/sqrt(sp2$values))%*%t(sp2$vectors)
K.hat <- Rxx.invsqrt%*%R.xy%*%Ryy.invsqrt
foo <- svd(K.hat)
sqrt(foo$d)
n <- 70;p<-3;q<-2;
r <- sqrt(foo$d)
Lambda0 <- prod(1-r^2)
obs <- -(n-(p+q+3)/2)*log(Lambda0)
1-pchisq(obs,df = p*q)
Lambda1 <- prod(1-r[2]^2)
obs2 <- -(n-(p+q+3)/2)*log(Lambda1)
s <- 1
1-pchisq(obs2,df = (p-s)*(q-s))
Rxx.invsqrt
Rxx.invsqrt%*%(-sp1$vectors[,1])
Ryy.invsqrt%*%sp2$vectors[,1]
G <- foo$u; D <- foo$v;
A.hat <- t(G)%*%Rxx.invsqrt
B.hat <- t(D)%*%Ryy.invsqrt
A.hat
B.hat
R <- matrix(c(1,0.6328,0.2412,0.0586,
0.6328,1,-0.0553,0.0655,
0.2412,-0.0553,1,0.4248,
0.0586,0.0655,0.4248,1),ncol = 4,byrow = T)
R.xx <- R[1:2,1:2]
R.xy <- R[1:2,3:4]
R.yx <- R[3:4,1:2]
R.yy <- R[3:4,3:4]
sp <- eigen(R.xx)
Rxx.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
sp <- eigen(R.yy)
Ryy.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
R <- matrix(c(1,0.6328,0.2412,0.0586,
0.6328,1,-0.0553,0.0655,
0.2412,-0.0553,1,0.4248,
0.0586,0.0655,0.4248,1),ncol = 4,byrow = T)
R.xx <- R[1:2,1:2]
R.xy <- R[1:2,3:4]
R.yx <- R[3:4,1:2]
R.yy <- R[3:4,3:4]
sp <- eigen(R.xx)
Rxx.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
sp <- eigen(R.yy)
Ryy.invsqrt <- sp$vectors%*%diag(1/sqrt(sp$values))%*%t(sp$vectors)
K.hat <- Rxx.invsqrt%*%R.xy%*%Ryy.invsqrt
foo <- svd(K.hat)
G <- foo$u; L <- diag(foo$d); D <- foo$v;
A.hat <- t(G)%*%Rxx.invsqrt
B.hat <- t(D)%*%Ryy.invsqrt
foo$d
A.hat
B.hat
n <- 140;p<-2;q<-2;
r <- foo$d
Lambda0 <- prod(1-r^2)
obs <- -(n-(p+q+3)/2)*log(Lambda0)
1-pchisq(obs,df = p*q)
Lambda1 <- prod(1-r[2]^2)
obs2 <- -(n-(p+q+3)/2)*log(Lambda1)
s <- 1
1-pchisq(obs2,df = (p-s)*(q-s))
R <- matrix(c(1,0.37,0.21,0.26,0.33,
0.37,1,0.35,0.67,0.59,
0.21,0.35,1,0.34,0.34,
0.26,0.67,0.34,1,0.8,
0.33,0.59,0.34,0.8,1),ncol = 5,byrow = T)
R.xx <- R[1:3,1:3]
R.xy <- R[1:3,4:5]
R.yx <- R[4:5,1:3]
R.yy <- R[4:5,4:5]
sp1 <- eigen(R.xx)
Rxx.invsqrt <- sp1$vectors%*%diag(1/sqrt(sp1$values))%*%t(sp1$vectors)
sp2 <- eigen(R.yy)
Ryy.invsqrt <- sp2$vectors%*%diag(1/sqrt(sp2$values))%*%t(sp2$vectors)
K.hat <- Rxx.invsqrt%*%R.xy%*%Ryy.invsqrt
foo <- svd(K.hat)
foo$d
n <- 70;p<-3;q<-2;
r <- foo$d
Lambda0 <- prod(1-r^2)
obs <- -(n-(p+q+3)/2)*log(Lambda0)
1-pchisq(obs,df = p*q)
Lambda1 <- prod(1-r[2]^2)
obs2 <- -(n-(p+q+3)/2)*log(Lambda1)
s <- 1
1-pchisq(obs2,df = (p-s)*(q-s))
G <- foo$u; D <- foo$v;
A.hat <- t(G)%*%Rxx.invsqrt
B.hat <- t(D)%*%Ryy.invsqrt
A.hat
B.hat
getwd()
setwd("C:/Users/50347/Documents/Github/Spring2018-Project4-grp5")
train_2 <- read.csv("data/data_matrix/train_2.csv")
rm(train_2)
train <- read.csv("data/data_matrix/train_2.csv")
train[1:5,1:5]
train <- train[,-1]
train[1:5,1:5]
train1 <- read.csv(train <- read.csv("data/data_matrix/train_1.csv"))
train1 <- read.csv("data/data_matrix/train_1.csv")
train1[is.na(train1)] <- 0
train[1:5,1:5]
train1[1:5,1:5]
write.csv(train1,file = "train_1.csv")
table(train)
test1 <- read.csv("data/data_matrix/test_1.csv")
test1[is.na(test1)] <- 0
write.csv(test1,file = "test_1.csv")
test1[1:5,1:5]
train <- read.csv("data/data_matrix/train_2.csv")
rm(train10)
rm(train1)
rm(test1)
train[1:5,1:5]
rownames(train) <- train[,2]
train <- train[,-c(1,2)]
train[1;5,1:5]
train[1:5,1:5]
?match
train1 <- read.csv("data/data_matrix/train_1.csv")
train1 <- read.csv("data/data_matrix/train_1.csv")
getwd()
train1 <- read.csv("data/data_matrix/train_1.csv")
train1 <- read.csv("data/data_matrix/train_1.csv")
?read.csv
train1 <- read.csv("data/data_matrix/train_1.csv")
getwd()
